<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEXUS ONE</title>
    <style>
        :root {
            --bg: #0a0a0a;
            --card: rgba(30, 30, 30, 0.7);
            --card-border: 1px solid rgba(255, 255, 255, 0.1);
            --glass: blur(12px);
            --text: #ffffff;
            --accent: #8a2be2;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0; padding: 20px;
            overflow-x: hidden;
            padding-bottom: 50px;
        }

        /* PERFORMANCE & LAYOUT */
        .container { max-width: 600px; margin: 0 auto; display: flex; flex-direction: column; gap: 15px; }
        
        /* HEADER & CONTROLS */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        h1 { margin: 0; font-size: 24px; background: linear-gradient(90deg, #fff, #aaa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .controls { display: flex; gap: 10px; }
        .btn-small { background: rgba(255,255,255,0.1); border: none; color: #fff; padding: 5px 10px; border-radius: 8px; cursor: pointer; font-size: 12px; }

        /* GLASS CARD STYLE */
        .card {
            background: var(--card);
            backdrop-filter: var(--glass);
            -webkit-backdrop-filter: var(--glass);
            border: var(--card-border);
            border-radius: 16px;
            padding: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            transition: transform 0.2s;
        }

        /* NEWS SECTION (LIVE) */
        .news-header { display: flex; justify-content: space-between; margin-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 5px; }
        .live-badge { background: red; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
        
        .news-item { margin-bottom: 10px; font-size: 14px; line-height: 1.4; display: flex; flex-direction: column; }
        .news-time { font-size: 11px; color: #aaa; margin-bottom: 2px; }
        .news-headline { font-weight: 500; }

        /* FINANCE TICKER */
        .ticker-wrap { overflow: hidden; white-space: nowrap; margin-bottom: 5px; }
        .ticker { display: inline-block; animation: ticker 20s linear infinite; }
        .tick { display: inline-block; margin-right: 20px; font-size: 13px; font-family: monospace; }
        .up { color: #00ff88; } .down { color: #ff5555; }
        @keyframes ticker { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

        /* INPUT AREA */
        .input-group { display: flex; gap: 8px; flex-wrap: wrap; }
        input, select {
            background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); color: white;
            padding: 10px; border-radius: 8px; flex: 1; font-size: 14px; outline: none;
        }
        select { flex: 0.6; }
        .btn-add {
            background: linear-gradient(135deg, var(--accent), #555); color: white; border: none;
            padding: 10px 20px; border-radius: 8px; font-weight: bold; cursor: pointer;
        }

        /* TASKS */
        .task-list { display: flex; flex-direction: column; gap: 8px; margin-top: 10px; }
        
        .task-row {
            display: flex; align-items: center; justify-content: space-between;
            padding: 12px; border-radius: 12px;
            background: rgba(40,40,40,0.6);
            border: 1px solid rgba(255,255,255,0.05);
            /* Glassy Checkbox Area */
            position: relative; overflow: hidden;
        }

        /* CATEGORY COLORS (GLOW & BORDER) */
        .cat-finanzen { border-left: 3px solid #ffd700; box-shadow: inset 10px 0 20px -10px rgba(255, 215, 0, 0.2); }
        .cat-schule { border-left: 3px solid #00bfff; box-shadow: inset 10px 0 20px -10px rgba(0, 191, 255, 0.2); }
        .cat-sport { border-left: 3px solid #ff1493; box-shadow: inset 10px 0 20px -10px rgba(255, 20, 147, 0.2); }
        .cat-hausarbeit { border-left: 3px solid #ff4500; box-shadow: inset 10px 0 20px -10px rgba(255, 69, 0, 0.2); }
        .cat-freizeit { border-left: 3px solid #32cd32; box-shadow: inset 10px 0 20px -10px rgba(50, 205, 50, 0.2); }

        .task-info { display: flex; flex-direction: column; flex: 1; margin-left: 10px; }
        .task-title { font-size: 15px; }
        .task-meta { font-size: 11px; color: #888; display: flex; gap: 5px; align-items: center; }
        
        /* GLASSY CHECKBOX */
        .check-container {
            position: relative; width: 24px; height: 24px;
            background: rgba(255,255,255,0.1); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; border: 1px solid rgba(255,255,255,0.2);
            backdrop-filter: blur(4px);
        }
        .check-container.checked { background: var(--accent); border-color: var(--accent); }
        .checkmark { display: none; color: white; font-size: 14px; }
        .check-container.checked .checkmark { display: block; }

        .daily-icon { font-size: 10px; background: rgba(255,255,255,0.2); padding: 2px 4px; border-radius: 4px; }

        /* AI CHAT MINI */
        .ai-mini { height: 150px; overflow-y: auto; font-size: 13px; color: #ccc; margin-bottom: 5px; }
        .ai-msg { margin-bottom: 5px; padding: 5px 10px; background: rgba(0,0,0,0.3); border-radius: 8px; display: inline-block; }

        /* TOGGLE ANIMATIONS CLASS */
        .no-anim * { animation: none !important; transition: none !important; }

    </style>
</head>
<body>

<div class="container">
    
    <!-- HEADLINE -->
    <div class="header">
        <h1>NEXUS ONE</h1>
        <div class="controls">
            <button class="btn-small" onclick="toggleAnim()">‚ú® Anim: An</button>
            <button class="btn-small" onclick="manualSync()">‚òÅÔ∏è Sync</button>
        </div>
    </div>

    <!-- 1. NEWS & FINANCE CARD -->
    <div class="card">
        <div class="ticker-wrap">
            <div class="ticker">
                <span class="tick">DAX <span class="up">+0.8%</span></span>
                <span class="tick">GOLD <span class="up">$2,045</span></span>
                <span class="tick">BTC <span class="down">$94,200</span></span>
                <span class="tick">EUR/USD <span class="up">1.09</span></span>
                <span class="tick">S&P 500 <span class="down">-0.2%</span></span>
            </div>
        </div>
        <div class="news-header">
            <span style="font-weight:bold; font-size:14px;">Welt News (Tagesschau)</span>
            <span class="live-badge">LIVE</span>
        </div>
        <div id="news-container">Lade Nachrichten...</div>
    </div>

    <!-- 2. KI ASSISTANT CARD -->
    <div class="card">
        <div class="ai-mini" id="ai-chat">
            <div class="ai-msg">KI: Hi! Ich analysiere deine Aufgaben und News.</div>
        </div>
        <div class="input-group">
            <input type="text" id="ai-input" placeholder="Frage an KI...">
            <button class="btn-small" onclick="askAI()">Send</button>
        </div>
    </div>

    <!-- 3. PLANNER INPUT -->
    <div class="card">
        <div class="input-group">
            <input type="text" id="t-title" placeholder="Aufgabe..." style="flex:2;">
            <input type="time" id="t-time" style="flex:1;">
        </div>
        <div class="input-group" style="margin-top:8px;">
            <select id="t-cat">
                <option value="finanzen">Finanzen üí∞</option>
                <option value="schule">Schule üìö</option>
                <option value="hausarbeit">Hausarbeit üè†</option>
                <option value="freizeit">Freizeit üéÆ</option>
                <option value="sport">Sport üèãÔ∏è</option>
            </select>
            <div style="display:flex; align-items:center; gap:5px; color:#aaa; font-size:12px;">
                <input type="checkbox" id="t-daily" style="width:16px; height:16px; flex:0;"> T√§glich?
            </div>
            <button class="btn-add" onclick="addTask()">+ Add</button>
        </div>
    </div>

    <!-- 4. TASK LIST -->
    <div id="task-list" class="task-list">
        <!-- Tasks render here -->
    </div>

</div>

<script>
    /* --- CONFIG --- */
    let useAnim = true;
    let tasks = [];
    
    // API KEYS (Optional)
    let API_KEY = ""; 
    let BIN_ID = "";

    /* --- INIT --- */
    window.onload = function() {
        if(localStorage.getItem('nexus_tasks')) {
            tasks = JSON.parse(localStorage.getItem('nexus_tasks'));
            checkDailyReset(); // Pr√ºft ob "T√§glich" Aufgaben resetet werden m√ºssen
            renderTasks();
        }
        fetchNews();
        setInterval(fetchNews, 600000); // 10 Min Refresh
    };

    /* --- NEWS LOGIC (REAL TAGESSCHAU) --- */
    async function fetchNews() {
        const container = document.getElementById('news-container');
        // Wir nutzen einen RSS2JSON Service f√ºr den offiziellen Tagesschau Feed
        const rssUrl = 'https://www.tagesschau.de/infoservices/alle-meldungen-100~rss2.xml';
        const apiUrl = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(rssUrl)}`;

        try {
            const res = await fetch(apiUrl);
            const data = await res.json();
            
            let html = "";
            // Nimm die ersten 3 News
            data.items.slice(0, 3).forEach(item => {
                const time = new Date(item.pubDate).toLocaleTimeString('de-DE', {hour:'2-digit', minute:'2-digit'});
                html += `
                    <div class="news-item">
                        <span class="news-time">${time} ‚Ä¢ Welt</span>
                        <a href="${item.link}" target="_blank" style="color:white; text-decoration:none;" class="news-headline">${item.title}</a>
                    </div>
                `;
            });
            container.innerHTML = html;
        } catch(e) {
            container.innerHTML = "<div class='news-item'>Konnte News nicht laden (Offline?).</div>";
        }
    }

    /* --- TASK LOGIC --- */
    function addTask() {
        const title = document.getElementById('t-title').value;
        const time = document.getElementById('t-time').value;
        const cat = document.getElementById('t-cat').value;
        const isDaily = document.getElementById('t-daily').checked;

        if(!title) return;

        tasks.push({
            id: Date.now(),
            title, time, cat, isDaily,
            done: false,
            lastDone: null // Datum wann zuletzt erledigt
        });

        // Cleanup Input
        document.getElementById('t-title').value = "";
        save();
        renderTasks();
    }

    function toggleTask(id) {
        const t = tasks.find(x => x.id === id);
        if(t) {
            t.done = !t.done;
            if(t.done && t.isDaily) t.lastDone = new Date().toDateString();
            save();
            renderTasks();
        }
    }

    function checkDailyReset() {
        const today = new Date().toDateString();
        let changed = false;
        tasks.forEach(t => {
            if(t.isDaily && t.lastDone !== today) {
                t.done = false; // Reset daily task if new day
                changed = true;
            }
        });
        if(changed) save();
    }

    function deleteTask(id) {
        if(confirm("L√∂schen?")) {
            tasks = tasks.filter(t => t.id !== id);
            save();
            renderTasks();
        }
    }

    function renderTasks() {
        const list = document.getElementById('task-list');
        list.innerHTML = "";
        
        // Sortieren: Zeit
        tasks.sort((a,b) => (a.time || "23:59").localeCompare(b.time || "23:59"));

        tasks.forEach(t => {
            const div = document.createElement('div');
            div.className = `task-row cat-${t.cat}`;
            if(t.done) div.style.opacity = "0.5";

            div.innerHTML = `
                <div class="check-container ${t.done ? 'checked' : ''}" onclick="toggleTask(${t.id})">
                    <span class="checkmark">‚úî</span>
                </div>
                <div class="task-info">
                    <span class="task-title" style="text-decoration: ${t.done ? 'line-through' : 'none'}">${t.title}</span>
                    <div class="task-meta">
                        <span>${t.time || ''}</span>
                        ${t.isDaily ? '<span class="daily-icon">‚Üª T√§glich</span>' : ''}
                        <span style="text-transform:capitalize">‚Ä¢ ${t.cat}</span>
                    </div>
                </div>
                <button onclick="deleteTask(${t.id})" style="background:none; border:none; color:#555; font-size:16px;">√ó</button>
            `;
            list.appendChild(div);
        });
    }

    function save() {
        localStorage.setItem('nexus_tasks', JSON.stringify(tasks));
    }

    /* --- AI LOGIC --- */
    function askAI() {
        const inp = document.getElementById('ai-input');
        const box = document.getElementById('ai-chat');
        const q = inp.value;
        if(!q) return;

        box.innerHTML += `<div class="ai-msg" style="color:var(--accent)">Du: ${q}</div>`;
        inp.value = "";
        
        // Simuliere Antwort basierend auf Kontext
        setTimeout(() => {
            let a = "Ich habe das notiert.";
            if(q.toLowerCase().includes("finanz")) a = "Der DAX sieht stabil aus. Gold ist eine sichere Bank gerade.";
            if(q.toLowerCase().includes("aufgabe")) a = `Du hast noch ${tasks.filter(t=>!t.done).length} offene Aufgaben.`;
            
            box.innerHTML += `<div class="ai-msg">KI: ${a}</div>`;
            box.scrollTop = box.scrollHeight;
        }, 500);
    }

    /* --- SYSTEM --- */
    function toggleAnim() {
        useAnim = !useAnim;
        document.body.classList.toggle('no-anim');
        const btn = document.querySelector('.controls button');
        btn.innerText = useAnim ? "‚ú® Anim: An" : "üö´ Anim: Aus";
    }

    async function manualSync() {
        let key = API_KEY || prompt("Master Key:");
        let bin = BIN_ID || prompt("Bin ID:");
        if(!key || !bin) return;
        
        // Simple Upload Logic
        try {
            await fetch(`https://api.jsonbin.io/v3/b/${bin}`, {
                method: 'PUT',
                headers: {'Content-Type': 'application/json', 'X-Master-Key': key},
                body: JSON.stringify({tasks: tasks})
            });
            alert("Gespeichert!");
        } catch(e) { alert("Fehler!"); }
    }

</script>
</body>
</html>
