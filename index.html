<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS PRIME v31.5 | Stable Cloud</title>
    <style>
        :root {
            --bg-color: #0a0a0a;
            --card-bg: #141414;
            --accent: #00d4ff;
            --text-main: #ffffff;
            --text-dim: #888888;
            --border: #333;
            --font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: var(--font-family);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        /* HEADER */
        header {
            width: 100%;
            max-width: 1000px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid var(--border);
            margin-bottom: 20px;
        }

        .logo { font-size: 1.5rem; font-weight: 700; letter-spacing: 2px; }
        .logo span { color: var(--accent); }
        .status { font-size: 0.8rem; color: #555; }

        /* GRID LAYOUT (Das bewährte V31 Grid) */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            width: 100%;
            max-width: 1000px;
        }

        .card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            transition: transform 0.2s;
        }
        .card:hover { transform: translateY(-2px); border-color: var(--accent); }

        h2 { font-size: 1.1rem; margin-bottom: 15px; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1px; }

        /* WIDGETS */
        .time-display { font-size: 3rem; font-weight: 700; text-align: center; margin: 10px 0; }
        .date-display { text-align: center; color: var(--accent); margin-bottom: 10px; }

        /* FINANCE CONTAINER */
        .finance-container { height: 350px; }

        /* AI CHAT */
        #ai-response {
            background: #000;
            padding: 15px;
            border-radius: 8px;
            min-height: 60px;
            margin-bottom: 15px;
            font-size: 0.95rem;
            line-height: 1.5;
            border-left: 3px solid var(--accent);
        }
        .input-group { display: flex; gap: 10px; }
        input[type="text"] {
            flex: 1;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: #222;
            color: white;
            outline: none;
        }
        button {
            padding: 12px 20px;
            background: var(--accent);
            border: none;
            border-radius: 8px;
            color: #000;
            font-weight: bold;
            cursor: pointer;
        }

        /* CLOUD TEXT AREA (Statt statischer Liste) */
        textarea.cloud-notes {
            width: 100%;
            height: 200px;
            background: #111;
            border: 1px solid #333;
            color: #ddd;
            padding: 10px;
            border-radius: 8px;
            resize: none;
            font-family: inherit;
        }
        textarea.cloud-notes:focus { border-color: var(--accent); color: white; }

        /* NEWS TICKER */
        .news-ticker {
            width: 100%; max-width: 1000px;
            background: #111; border-bottom: 1px solid #333; margin-bottom: 20px;
            overflow: hidden; white-space: nowrap; padding: 10px 0;
            color: var(--text-dim); font-size: 0.9rem;
        }
    </style>
</head>
<body>

    <header>
        <div class="logo">NEXUS <span>PRIME</span></div>
        <div class="status" id="sync-status">Connecting...</div>
    </header>

    <div class="news-ticker">
        +++ NEXUS PRIME v31.5 +++ System Stable +++ Auto-Cloud Active +++ Markets Open +++
    </div>

    <div class="dashboard">
        
        <!-- 1. ZEIT -->
        <div class="card">
            <h2>Chronometer</h2>
            <div class="time-display" id="clock">00:00</div>
            <div class="date-display" id="date">Lade...</div>
        </div>

        <!-- 2. AI -->
        <div class="card">
            <h2>Neural Core</h2>
            <div id="ai-response">System bereit.</div>
            <div class="input-group">
                <input type="text" id="userInput" placeholder="Frage..." onkeypress="if(event.key==='Enter') askAI()">
                <button onclick="askAI()">Go</button>
            </div>
        </div>

        <!-- 3. FINANZEN -->
        <div class="card" style="grid-row: span 2;">
            <h2>Market Data</h2>
            <div class="finance-container">
                <!-- TradingView Widget -->
                <div class="tradingview-widget-container" style="height:100%;width:100%">
                    <div class="tradingview-widget-container__widget" style="height:100%;width:100%"></div>
                    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-overview.js" async>
                    {
                    "colorTheme": "dark",
                    "dateRange": "12M",
                    "showChart": true,
                    "locale": "de_DE",
                    "width": "100%",
                    "height": "100%",
                    "largeChartUrl": "",
                    "isTransparent": true,
                    "tabs": [
                        {
                        "title": "Portfolio",
                        "symbols": [
                            { "s": "XETR:IUSQ", "d": "MSCI World" },
                            { "s": "TVC:GOLD", "d": "Gold" },
                            { "s": "BITSTAMP:BTCUSD", "d": "Bitcoin" }
                        ]
                        }
                    ]
                    }
                    </script>
                </div>
            </div>
        </div>

        <!-- 4. PROTOKOLL (CLOUD SYNCED) -->
        <div class="card">
            <h2>Daily Protocol (Cloud)</h2>
            <textarea class="cloud-notes" id="dailyNotes" placeholder="Schreibe hier deinen Tagesplan..." oninput="triggerAutoSave()"></textarea>
        </div>

    </div>

    <script>
        // ==========================================
        // KONFIGURATION
        // ==========================================
        const API_KEY = $2a$10$bfQHPAKf8rHB5nCB1nxla.8UbbBLCu6uCSZjrrePZ2JvQv9Jw3XEK; 
        const BIN_ID  = 6983be0443b1c97be965d28c;
        // ==========================================

        // STARTUP
        window.onload = function() {
            updateTime();
            setInterval(updateTime, 1000);
            loadFromCloud();
        };

        // ZEIT
        function updateTime() {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString('de-DE', {hour:'2-digit', minute:'2-digit'});
            document.getElementById('date').innerText = now.toLocaleDateString('de-DE', {weekday:'long', day:'numeric', month:'long'});
        }

        // CLOUD LOGIC
        let saveTimer;

        async function loadFromCloud() {
            const status = document.getElementById('sync-status');
            status.innerText = "Syncing...";
            
            try {
                let res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
                    headers: { "X-Master-Key": API_KEY }
                });
                
                if (res.ok) {
                    let json = await res.json();
                    if(json.record.notes) {
                        document.getElementById('dailyNotes').value = json.record.notes;
                    }
                    status.innerText = "Online (v31.5)";
                    status.style.color = "#00d4ff";
                } else {
                    status.innerText = "Sync Error (Check Key)";
                }
            } catch (e) {
                status.innerText = "Offline Mode";
            }
        }

        function triggerAutoSave() {
            clearTimeout(saveTimer);
            document.getElementById('sync-status').innerText = "Typing...";
            saveTimer = setTimeout(saveToCloud, 2000);
        }

        async function saveToCloud() {
            const status = document.getElementById('sync-status');
            status.innerText = "Saving...";
            
            let data = {
                notes: document.getElementById('dailyNotes').value,
                lastUpdate: new Date().toISOString()
            };

            try {
                await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
                    method: "PUT",
                    headers: { "Content-Type": "application/json", "X-Master-Key": API_KEY },
                    body: JSON.stringify(data)
                });
                status.innerText = "Saved";
                setTimeout(() => status.innerText = "Online", 2000);
            } catch (e) {
                status.innerText = "Save Failed";
            }
        }

        // AI LOGIC (Simple)
        function askAI() {
            const input = document.getElementById('userInput').value.toLowerCase();
            const output = document.getElementById('ai-response');
            let ans = "Verstanden.";

            if(input.includes("hallo")) ans = "Systeme stabil.";
            else if(input.includes("stress")) ans = "Mach eine Pause.";
            else if(input.includes("börse")) ans = "Siehe Chart rechts.";
            
            output.innerText = ans;
            document.getElementById('userInput').value = "";
        }

    </script>
</body>
</html>
